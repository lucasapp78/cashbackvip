<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>L.A Cashback VIP 👑</title>
  <style>
    /* (estilos permanecem os mesmos) */
  </style>
</head>
<body>
  <h2>L.A Cashback VIP 👑</h2>

  <label for="liga">Campeonato:</label>
  <select id="liga">
    <option value="soccer_brazil_serie_a">Brasileirão - Série A</option>
    <option value="soccer_brazil_serie_b">Brasileirão - Série B</option>
    <option value="soccer_epl">Premier League</option>
    <option value="soccer_spain_la_liga">La Liga</option>
    <option value="soccer_uefa_champs_league">Champions League</option>
    <option value="soccer_uefa_europa_league">Europa League</option>
  </select>

  <div style="display: flex; gap: 10px;">
    <div style="flex:1">
      <label for="oddMin">Odd mínima:</label>
      <input type="number" id="oddMin" step="0.01" value="1.10" />
    </div>
    <div style="flex:1">
      <label for="oddMax">Odd máxima:</label>
      <input type="number" id="oddMax" step="0.01" value="10.00" />
    </div>
  </div>

  <button onclick="carregarOddsReais()">🔄 Carregar Odds Reais</button>

  <input type="text" id="filtro" class="search-bar" placeholder="Filtrar por nome do time...">

  <div class="button-group">
    <button onclick="selecionarTodos()">Selecionar Todos</button>
    <button onclick="limparSelecao()">Limpar Seleção</button>
  </div>

  <div id="inputs"></div>

  <label for="tipoDesdobramento">Tipo de aposta (acertos):</label>
  <select id="tipoDesdobramento">
    <option value="1">1 (simples)</option><option value="2">2 (duplas)</option>
    <option value="3">3 (trios)</option><option value="4">4 (quartetos)</option>
    <option value="5">5 (quinas)</option><option value="6">6 (senas)</option>
    <option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>
  </select>

  <input type="number" step="0.01" placeholder="Valor por combinação (R$)" id="stake" value="10" />
  <button onclick="gerarDesdobramento()">Gerar L.A Cashback VIP 👑</button>
  <div id="resultado"></div>

<script>
async function carregarOddsReais() {
  const API_KEY = "d4d52d8e8d186ecee91808ff600dcd63";
  const liga = document.getElementById("liga")?.value || "soccer_brazil_serie_a";
  const mercados = ["h2h", "btts", "totals", "correct_score"];
  const url = `https://api.the-odds-api.com/v4/sports/${liga}/odds/?regions=us&markets=${mercados.join(',')}&oddsFormat=decimal&apiKey=${API_KEY}`;
  const oddMin = parseFloat(document.getElementById("oddMin").value) || 1.10;
  const oddMax = parseFloat(document.getElementById("oddMax").value) || 10.00;

  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error("Erro na resposta da API");

    const data = await response.json();
    const inputs = document.getElementById("inputs");
    inputs.innerHTML = "";
    let jogoCount = 0;

    data.sort((a, b) => new Date(a.commence_time) - new Date(b.commence_time));

    data.forEach(jogo => {
      const mercadosJogo = jogo?.bookmakers?.[0]?.markets || [];
      let bloco = '';
      let adicionou = false;

      mercadosJogo.forEach(mercado => {
        mercado.outcomes?.forEach(outcome => {
          // if (outcome.price >= oddMin && outcome.price <= oddMax) {
          if (true) { // <-- TEMPORÁRIO: Mostra todas as odds para depuração
            adicionou = true;
            let icon = "🎯";
            const nomeMercado = mercado.key.toLowerCase();

            if (nomeMercado === "h2h") {
              icon = outcome.name === jogo.home_team ? "🏠" :
                     outcome.name === "Draw" ? "⚖️" :
                     outcome.name === jogo.away_team ? "🚩" : "🎯";
            } else if (nomeMercado === "btts") {
              icon = outcome.name === "Yes" ? "✅" : outcome.name === "No" ? "❌" : "🎯";
            } else if (nomeMercado === "totals") {
              icon = outcome.name.includes("Over") ? "⬆️" : outcome.name.includes("Under") ? "⬇️" : "🎯";
            } else if (nomeMercado === "correct_score") {
              icon = "📊";
            }

            const nomeDescritivo = `${jogo.home_team} vs ${jogo.away_team} - ${mercado.key.toUpperCase()}: ${outcome.name}${outcome.point ? ` (${outcome.point})` : ``}`;

            bloco += `
              <div class="game-option">
                <input type="checkbox" class="jogoCheck"
                       data-nome="${nomeDescritivo}"
                       data-odd="${outcome.price.toFixed(2)}" />
                <span class="icon">${icon}</span> ${mercado.key.toUpperCase()} - ${outcome.name} @ ${outcome.price.toFixed(2)}
              </div>`;
          }
        });
      });

      if (adicionou) {
        jogoCount++;
        const dataHora = new Date(jogo.commence_time);
        const formatter = new Intl.DateTimeFormat("pt-BR", {
          weekday: "short", day: "2-digit", month: "2-digit", hour: "2-digit", minute: "2-digit"
        });
        const horario = formatter.format(dataHora).replace(",", " às");
        const casa = jogo?.bookmakers?.[0]?.title || "Desconhecida";

        inputs.innerHTML += `
          <div class="game-card" data-times="${jogo.home_team.toLowerCase()} ${jogo.away_team.toLowerCase()}">
            <div class="game-title">${jogo.home_team} vs ${jogo.away_team}</div>
            <div style="font-size: 0.9rem; color: #555;">🕒 ${horario} | 🏦 ${casa}</div>
            <div style="margin-top: 10px;">${bloco}</div>
          </div>`;
      }
    });

    if (jogoCount === 0) {
      inputs.innerHTML = "<p style='color:red;'>Nenhuma odd encontrada no intervalo definido.</p>";
    } else {
      alert("Selecione os resultados desejados para apostar.");
    }
  } catch (err) {
    console.error("Erro ao buscar odds reais:", err);
    alert("Erro ao buscar odds. Tente novamente mais tarde.");
  }
}
</script>
</body>
</html>
